<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Multicolour documentation routing</title>

  <!-- Base -->
<meta name="identifier-url" content="site.url" />
<meta name="title" content="Multicolour documentation routing" />
<meta name="description" content="Multicolour documentation on generated routes and creating custom routes." />
<meta name="abstract" content="Routing" />
<meta name="keywords" content="multicolour, REST API routes, routing" />
<meta name="author" content="New World Code Ltd" />
<meta name="revisit-after" content="7" />
<meta name="language" content="EN" />
<meta name="copyright" content="© 2017 New World Code Ltd" />
<meta name="robots" content="Index" />


<!-- Social -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@getmulticolour">
<meta name="twitter:title" content="Multicolour documentation routing">
<meta name="twitter:description" content="Routing">
<meta name="twitter:creator" content="@getmulticolour">
<meta name="twitter:image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png">

<meta itemprop="name" content="Multicolour documentation routing">
<meta itemprop="description" content="Routing">
<meta itemprop="image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png">

<meta property="og:title" content="Multicolour documentation routing" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://0.0.0.0:4000" />
<meta property="og:image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png" />
<meta property="og:description" content="Routing" />
<meta property="og:site_name" content="Multicolour documentation routing" />

<link rel="apple-touch-icon" sizes="57x57" href="/images/iconography/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/iconography/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/iconography/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/iconography/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/iconography/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/iconography/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/iconography/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/iconography/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/iconography/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/images/iconography/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/iconography/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/iconography/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/iconography/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="ms-icon-144x144.png">
<meta name="theme-color" content="#FF9999">



  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,300" rel="stylesheet" type="text/css" async>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://0.0.0.0:4000/docs/0.6.3/routing/">
  <link rel="alternate" type="application/rss+xml" title="Multicolour - Rest API generator" href="http://0.0.0.0:4000/feed.xml">
</head>


<body>
    <main>
      <nav class="general-nav">
    <a href="/" class="logo-link no-border">
        <img class="nav-logo" src="/images/logo-stamp.svg" alt="Multicolour - NodeJS REST API generator.">
    </a>
    <ul class="menu">
        <li>
            <a href="/examples" title="Multicolour rest api generator examples">examples</a>
        </li>
        <li>
            <a href="/docs/" title="Multicolour docs">docs</a>
        </li>
        <li>
            <a href="/blog" title="Multicolour blog">blog</a>
        </li>
    </ul>
</nav>

      <section class="columns">
        <aside>
            
            <h2 class="docs-title">Docs <span>0.6.3</span></h2>
            
            <section class="search">
                <input type="search" name="search" placeholder="search the docs">
            </section>

            
            <ul>
  
  
    <li
      data-keywords="multicolour API, API reference"
      
      >
      <a href="/docs/0.6.3/api-reference" title="Multicolour core API reference">
        API Reference
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, cli"
      
      >
      <a href="/docs/0.6.3/cli" title="Multicolour documentation CLI">
        CLI
      </a>
      

      
    </li>
  
    <li
      data-keywords="waterline blueprints, multicolour collection"
      
      >
      <a href="/docs/0.6.3/collections/" title="Multicolour documentation collections">
        Collections/Blueprints
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour config, server configuration, rest api config"
      
      >
      <a href="/docs/0.6.3/configuration" title="Multicolour documentation configuration">
        Configuration
      </a>
      

      
    </li>
  
    <li
      data-keywords="codeless business logic, multicolour constraints"
      
      >
      <a href="/docs/0.6.3/collections/constraints/" title="Multicolour documentation constraints">
        Constraints
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, rest api, debugging"
      
      >
      <a href="/docs/0.6.3/debugging" title="Multicolour documentation debugging tips">
        Debugging
      </a>
      

      
    </li>
  
    <li
      data-keywords=""
      
      >
      <a href="/docs/0.6.3/quickstart" title="Multicolour quickstart">
        Quickstart
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, javascript sdk"
      
      >
      <a href="/docs/0.6.3/javascript-sdk" title="Multicolour documentation JavaScript SDK generator">
        JavaScript SDK
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, plugins, rest api business logic"
      
      >
      <a href="/docs/0.6.3/plugins" title="Multicolour documentation plugins">
        Writing plugins
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, REST API routes, routing"
      
      class="active">
        Routing
      

      
    </li>
  
    <li
      data-keywords="file uploads, multicolour, rest api file uploads"
      
      >
      <a href="/docs/0.6.3/routing/file-uploads/" title="Multicolour documentation file uploads">
        Uploading files
      </a>
      

      
    </li>
  
</ul>

            
        </aside>
        <article>
          <h1 id="routing">Routing</h1>

<p>Multicolour generates a lot of routes for you but your business logic is exactly that, it’s yours and yours only. Multicolour doesn’t try to handle that for you but saves you the time getting there.</p>

<p>By default Multicolour generates your CRUD interface and configures your auth, validations and Swagger documentation.</p>

<p>Multicolour generates the following for you.</p>

<ul>
  <li><code class="highlighter-rouge">POST /{identity}</code> Create a new <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code></li>
  <li><code class="highlighter-rouge">PUT /{identity}</code> Update or create a <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code></li>
  <li><code class="highlighter-rouge">GET /{identity}?page={page}</code> Get a paginated  list of <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code></li>
  <li><code class="highlighter-rouge">GET /{identity}/{id}</code> Get a single <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code> by <code class="highlighter-rouge"><span class="p">{</span><span class="err">id</span><span class="p">}</span></code></li>
  <li><code class="highlighter-rouge">GET /{identity}?{query}&amp;page={page}</code> Get a paginated list of <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code> where <code class="highlighter-rouge"><span class="p">{</span><span class="err">query</span><span class="p">}</span></code></li>
  <li><code class="highlighter-rouge">PATCH /{identity}</code> Update a <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code></li>
  <li><code class="highlighter-rouge">DELETE /{identity}</code> Permanently remove a <code class="highlighter-rouge"><span class="p">{</span><span class="err">identity</span><span class="p">}</span></code></li>
</ul>

<p>Creating your own routes is simple, currently custom routes are not transportable between server technologies but may be in the future.</p>

<h2 id="the-handlers">The handlers</h2>

<p>Multicolour core supplies handlers for pretty much all your verbs out of the box, you can access and use them anytime by <code class="highlighter-rouge">get</code>ting them from core like below.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">handlers</span> <span class="o">=</span> <span class="nx">my_service</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"handlers"</span><span class="p">)</span>

<span class="c1">// handlers -&gt; Multicolour_Route_Templates</span></code></pre></figure>

<h2 id="multicolour_route_templates-class"><code class="highlighter-rouge">Multicolour_Route_Templates</code> class</h2>

<p>This class contains all the handlers/route templates, they do the work on the database with the  request data for you. The methods all share the same signature of</p>

<p><code class="highlighter-rouge">[VERB](model, request, reply)</code></p>

<p>Where <code class="highlighter-rouge">[VERB]</code> is one of the following</p>

<figure class="highlight"><pre><code class="language-text" data-lang="text">POST - Create stuff.
GET - Read stuff.
PATCH - Update stuff.
PUT - Update or create stuff.
DELETE - Delete stuff.
UPLOAD - Upload stuff.</code></pre></figure>

<p>and where model is retrieved from <code class="highlighter-rouge">my_service.get("database").get("models")</code></p>

<h2 id="creating-custom-routes">Creating custom routes</h2>

<p>You have had a request from the client asking for something Multicolour hasn’t already given you, it’s time to write a custom route and handler.</p>

<p>Add a <code class="highlighter-rouge">custom_route</code> property to your blueprint:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="nl">attributes</span><span class="p">:</span> <span class="p">{...},</span>
  <span class="nx">custom_routes</span><span class="err">:</span> <span class="kd">function</span> <span class="nx">custom_routes</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">multicolour</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Route based on your server technology here.</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Multicolour does not interfere, know about or modify anything you do inside of this function. This is your domain and you are free to do what you will.</p>

<p>An example route using the <code class="highlighter-rouge">hapi</code> server technology might look like this.</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="nl">attributes</span><span class="p">:</span> <span class="p">{...},</span>
  <span class="nx">custom_routes</span><span class="err">:</span> <span class="kd">function</span> <span class="nx">custom_routes</span><span class="p">(</span><span class="nx">server</span><span class="p">,</span> <span class="nx">multicolour</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// this === this blueprint</span>
    <span class="nx">server</span><span class="p">.</span><span class="nx">route</span><span class="p">({</span>
      <span class="na">method</span><span class="p">:</span> <span class="s2">"GET"</span><span class="p">,</span>
      <span class="na">path</span><span class="p">:</span> <span class="s2">"/project/count"</span><span class="p">,</span>
      <span class="na">handler</span><span class="p">:</span> <span class="p">(</span><span class="nx">request</span><span class="p">,</span> <span class="nx">reply</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">this</span>
          <span class="p">.</span><span class="nx">count</span><span class="p">({})</span>
          <span class="p">.</span><span class="nx">exec</span><span class="p">((</span><span class="nx">err</span><span class="p">,</span> <span class="nx">count</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">reply</span><span class="p">[</span><span class="nx">multicolour</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s2">"decorator"</span><span class="p">)](</span><span class="nx">err</span> <span class="o">||</span> <span class="nx">count</span><span class="p">))</span>
      <span class="p">}</span>
    <span class="p">})</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="gotchas-while-writing-custom-routes">Gotchas while writing custom routes</h2>
<p>As mentioned above, Multicolour makes no effort to watch, change or interfere with your custom routes as we consider <code class="highlighter-rouge">custom_routes</code> to contain business critical logic.</p>

<h3 id="decorators">Decorators</h3>

<p>In order to “decorate” your reply, you should request the <code class="highlighter-rouge">decorator</code> property stored on Multicolour, <code class="highlighter-rouge">multicolour.request("decorator")</code>.</p>

<h3 id="auth">Auth</h3>

<p>If you wish to authenticate your custom routes in the same way that Multicolour authenticates your CRUD routes, you must do this manually.</p>

<h3 id="validation">Validation</h3>

<p>Payload and response validations are not created for you and you should implement this yourself.</p>

<h3 id="path-clashes">Path clashes</h3>

<p>If you need to write a custom handler for one of the CRUD operations, currently you need to flag to Multicolour that you don’t want to generate routes at all for this blueprint with the <code class="highlighter-rouge">NO_AUTO_GEN_ROUTES</code> property and write handlers for all the verbs you wish to support.</p>

<h3 id="associations">Associations</h3>

<p>You will not see associations automatically populated, Multicolour has however already fixed and made the associations to other blueprints for you so <code class="highlighter-rouge">.populateAll()</code> will work for your queries and any decorator plugin should automatically call this for you.</p>

        </article>
      </section>
    </main>

    <footer class="site-footer">

  <ul>
    <li>
      <a href="/code-of-conduct" title="Multicolour code of conduct">
        Code of Conduct
      </a>
    </li>
    <li>
      <a href="/Multicolour_Branding_Guidelines_2016.pdf" target="_blank" rel="nofollow noopener noreferrer">
        Branding guidelines
      </a>
    </li>
    <li>
      <a href="https://github.com/Multicolour" target="_blank" rel="nofollow noopener noreferrer">
        Github Organisation
      </a>
    </li>
  </ul>
  <p>&copy; All copyright to Get Multicolour &amp; New World Code Ltd 2017</p>
</footer>


    <script src="/js/main.js" async defer></script>
    <script>
      !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
        analytics.load("Qurt0kpTtzocuF8h8VgRH6ygztdQPK5i");
        analytics.page()
      }}();
    </script>
</body>

</html>
