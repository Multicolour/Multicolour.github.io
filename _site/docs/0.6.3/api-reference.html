<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Multicolour core API reference</title>

  <!-- Base -->
<meta name="identifier-url" content="site.url" />
<meta name="title" content="Multicolour core API reference" />
<meta name="description" content="Multicolour core API reference." />
<meta name="abstract" content="Multicolour" />
<meta name="keywords" content="multicolour API, API reference" />
<meta name="author" content="New World Code Ltd" />
<meta name="revisit-after" content="7" />
<meta name="language" content="EN" />
<meta name="copyright" content="© 2017 New World Code Ltd" />
<meta name="robots" content="Index" />


<!-- Social -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@getmulticolour">
<meta name="twitter:title" content="Multicolour core API reference">
<meta name="twitter:description" content="Multicolour">
<meta name="twitter:creator" content="@getmulticolour">
<meta name="twitter:image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png">

<meta itemprop="name" content="Multicolour core API reference">
<meta itemprop="description" content="Multicolour">
<meta itemprop="image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png">

<meta property="og:title" content="Multicolour core API reference" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://0.0.0.0:4000" />
<meta property="og:image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png" />
<meta property="og:description" content="Multicolour" />
<meta property="og:site_name" content="Multicolour core API reference" />

<link rel="apple-touch-icon" sizes="57x57" href="/images/iconography/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/iconography/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/iconography/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/iconography/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/iconography/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/iconography/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/iconography/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/iconography/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/iconography/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/images/iconography/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/iconography/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/iconography/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/iconography/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="ms-icon-144x144.png">
<meta name="theme-color" content="#FF9999">



  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,300" rel="stylesheet" type="text/css" async>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://0.0.0.0:4000/docs/0.6.3/api-reference">
  <link rel="alternate" type="application/rss+xml" title="Multicolour - Rest API generator" href="http://0.0.0.0:4000/feed.xml">
</head>


<body>
    <main class="docs">
      <div class="general-nav">
    <nav>
        <a href="/" class="logo-link no-border" title="Multicolour - Rest API generator">
            <img class="nav-logo" src="/images/logo-stamp.svg" alt="Multicolour - Rest API generator">
        </a>

        <ul class="menu">
            <li>
                <a href="/examples/" title="Multicolour rest api generator examples">examples</a>
            </li>
            <li>
                <a href="/docs/" title="Multicolour docs">docs</a>
            </li>
            <li>
                <a href="/blog/" title="Multicolour blog">blog</a>
            </li>
        </ul>
    </nav>

    <menu class="breadcrumb-menu">
        <h1>Multicolour core API reference</h1>

        <div class="breadcrumbs">
  <a class="breadcrumbs-logo" href="/" title="Multicolour - Rest API generator">
    <img src="/images/iconography/android-icon-36x36.png" alt="Multicolour - Rest API generator">
  </a>

  <span class="arrow">&rarr;</span>

  
  
  <a href="/docs/" title="docs">
    docs
  </a>

  <span class="arrow">&rarr;</span>
  
  <a href="/docs/0.6.3/" title="0.6.3">
    0.6.3
  </a>

  <span class="arrow">&rarr;</span>
  
  

  <a class="current" href="/docs/0.6.3/api-reference" title="Multicolour core API reference">
    
    API Reference
    
  </a>
</div>

    </menu>
</div>


      <section class="columns">
        <aside>
            
            <h2 class="title">Docs <span>0.6.3</span></h2>
            
            <section class="search">
                <input type="search" name="search" placeholder="search the docs">
            </section>

            
            

<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "APIReference",
        "headline": "Multicolour core API reference",
        "assemblyVersion": "0.6.3",
        "executableLibraryName": "multicolour",
        "targetPlatform": "NodeJS",
        "keywords": "multicolour API, API reference",
        "learningResourceType": ["learning activity"],
        "wordCount": "1739",
        "datePublished": "2017-03-06 16:23:14 +0000",
        "url": "/docs/0.6.3/api-reference",
        "publisher": {
            "@type": "Organization",
            "name": "Multicolour",
            "sameAs": [
                "https://twitter.com/getmulticolour",
                "https://github.com/Multicolour"
            ],
            "logo": {
                "@type": "ImageObject",
                "contentUrl": "http://0.0.0.0:4000/images/logo.png",
                "url": "http://0.0.0.0:4000"
            }
        },
        "image":{
            "@type":"ImageObject",
            "contentUrl":"http://0.0.0.0:4000/images/social-header.jpg",
            "url":"http://0.0.0.0:4000",
            "height":"500",
            "width":"1500"
         },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http://0.0.0.0:4000/docs/0.6.3/api-reference"
        },
        "articleBody": "MulticolourMulticolour aims to make your life simpler, smarter and quicker by generating the boilerplate code for you including authentication and data representation layer.Multicolour core is a message bus, using the Talkie package.This allows Multicolour to act as two things:  An EventEmitter  a request and reply interfaceThe difference between the two is merely semantic, it allows us to make reading the code more natural and simplify certain aspects of the code resolution process (“What does this do?” .. “Oh, that.”)Multicolour “extends” all plugins with it’s message bus so all plugins have a predictable interface.new Multicolour({ config })Create an instance of Multicolour, config should be a valid configuration object for multicolour to scan for blueprints and connect to your databases.Returns: MulticolourExample:const Multicolour = require(&quot;multicolour&quot;)const my_service = new Multicolour({  content: `${__dirname}/content`})multicolour.get(key String)Get any of the following properties values from Multicolour core, some properties are only available once the service has been .start()-ed.  &quot;cli&quot; - Object Uninitialised CLI module.  &quot;config&quot; - Map The config as a Map, top level properties are also Maps.  &quot;env&quot; - String the process.env.NODE_ENV value at startup and &quot;development&quot; by default.  &quot;has_scanned&quot; - Boolean whether Multicolour has .scan()ned for blueprints.  &quot;package&quot; - Object The contents of the app’s package.json if any.  &quot;blueprints&quot; - Object Only available after .scan() has run.  &quot;validators&quot; - Multicolour_Default_Validation class instance for payload and response validation.  &quot;handlers&quot; - Multicolour_Route_Templates class instance which contain the default handlers for the database work.  &quot;database&quot; - Map Only available after .start() has completed, the database plugin.  &quot;server&quot; - Object Only available after .start() has completed, the server plugin.Returns: AnyExample:console.log(my_service.get(&quot;env&quot;)) // developmentGetting core modules such as database and server will return full plugin instances.–multicolour.get(&quot;database&quot;)Will return the full Multicolour_Waterline_Generator instance including the full waterline object and another Talkie interface.Available to .getmulticolour.get(&quot;database&quot;).get(&quot;models&quot;)An object of each, raw waterline collection registered.multicolour.get(&quot;database&quot;).get(&quot;waterline&quot;)The raw Waterline object underneath.–multicolour.get(&quot;server&quot;)A requirement of each server plugin is that it register as &quot;server&quot; on Multicolour coreAvailable to read:multicolour.get(&quot;server&quot;).request(&quot;raw&quot;)Raw server tech, be it Hapi or Express or whatever plugin you chose to use.multicolour.get(&quot;server&quot;).get(&quot;api_root&quot;)The final resolved url the API can be reached at, is 100% truth once the server has started and only a “guess” before the server_started event is emitted.The guess is 95% correct as it is derived from your configuration file but is not 100%.To read about what more is available to .get or .requestmulticolour.get(&quot;server&quot;).request(&quot;csrf_enabled&quot;)All endorsed server plugins are required to implement a way of enabling or disabling CSRF tokens for security reasons.This will return a Boolean as to whether CSRF token generation is enabled or not (defaults to false.)multicolour.get(&quot;server&quot;).get(&quot;flow_runner&quot;)Server plugins should implement a flow_runner used by Multicolour core as part of it’s built in integration testing framework. This should return an executable function.multicolour.request(key)Request a property from Multicolour, this is merely semantic sugar. Available properties are:  &quot;cli&quot; - CLI newly initialised CLI module.  &quot;new_uuid&quot; - String a unique v4 uuid.  &quot;storage&quot; - Get the current storage plugin.Returns: AnyExample:console.log(my_service.request(&quot;new_uuid&quot;)) // 5d31d224-bf23-49ed-9db0-7a50ab924f4fstatic new_from_config_file_path(config_location)Create a new instance of Multicolour from a config file location.Source CodeReturns: MulticolourExample:const my_service = require(&quot;multicolour&quot;).new_from_config_file_path(&quot;./config.js&quot;)multicolour.reset_from_config_path(config_location)Reset this instance of Multicolour with a config file location.Source CodeReturns: MulticolourExample:const Multicolour = require(&quot;multicolour&quot;)const my_service = Multicolour.new_from_config_file_path(&quot;./config.js&quot;)// Actually changed my mind.my_service.reset_from_config_path(&quot;./my-other-config.js&quot;)multicolour.cli()Start the CLI tools and parse arguments.Source CodeReturns: CLIExample:#!/usr/bin/env node// Get Multicolour.const Multicolour = require('multicolour')// Instantiate.new Multicolour().cli()multicolour._enable_user_model()Enable the core user model, usually done so by official authentication plugins.Will create a new table/collection in your database called multicolour_user.Source CodeReturns: MulticolourExample:// Get Multicolour.const my_service = require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()  ._enable_user_model()multicolour.scan()Tells Multicolour that you and the server are ready to be scanned for blueprints. The search path is dictated by the config.content property.Once scan has completed a new property is made available via the Multicolour.get() interface. These are  &quot;blueprints&quot;Source CodeReturns: MulticolourExample:const my_service = require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()multicolour.use(Plugin)Tell Multicolour to register and “use” the supplied plugin. Your plugin must have a register method on it.Source CodeReturns: MulticolourExample:class my_plugin {  register(Multicolour) {    Multicolour.reply(&quot;ping&quot;, &quot;pong&quot;)  }}const my_service = require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()  .use(my_plugin)console.log(my_service.request(&quot;ping&quot;)) // pongmulticolour.start(callback)Start the database server(s) and the http server and start listening for requests. When both services are ready callback is called.Triggersserver_startingdatabase_startingevents on the Multicolour instance and once services are started triggersserver_started database_started events.Also sets up a listener for SIGINT on the process so the services can be .stop()ped gracefullySource CodeReturns: MulticolourExample:require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()  .start(() =&amp;gt; console.log(&quot;Database server started&quot;))multicolour.stop(callback)Stop the database server(s) and the http server and stop listening for requests. When both services are stopped callback is called.Triggersdatabase_stoppingserver_stoppingevents on the Multicolour instance and once services are stopped triggersdatabase_stoppedserver_stoppedSource CodeReturns: MulticolourExample:const my_service = require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()my_service.start(() =&amp;gt; {  console.log(&quot;HTTP &amp;amp; Database server(s) started&quot;)  my_service.stop(() =&amp;gt; console.log(&quot;HTTP &amp;amp; Database server(s) stopped&quot;))})Request and Reply arbitrary dataTalkie enables Multicolour to act both as an EventEmitter and as a messaging bus to send arbitrary data to multiple places at once and on the object it extends.Talkie adds request and reply functions to all extended objects.multicolour.reply(name, data)When name is requested, it will receive the data unmodified.Example:multicolour.reply(&quot;my_awesome_plugin&quot;, new class {})multicolour.request(name)Purely syntactic sugar, is no different in functionality than .get(name).Example:const my_awesome_plugin = multicolour.request(&quot;my_awesome_plugin&quot;)EventEmitterMulticolour is an EventEmitter, events can be triggered and listened to using the standard interface for inter-plugin communication.At any point an event can be triggered and listened to in your app’s lifetime.All events are asyncronous, results from a trigger cannot be attained without providing a callback in the data sent.All plugins that used by Multicolour are also made into message busses with the exact same interface as Multicolour and access to all the Multicolour events.EventsThese events are fired from core and emit no data.database_startingEmitted with no data when a database startup has been started.database_startedEmitted with no data when a database startup has completed.database_stoppingEmitted with no data when a database shutdown has been started.database_stoppedEmitted with no data when a database shutdown has completed.server_stoppingEmitted with no data when a HTTP server shutdown has been started.server_stoppedEmitted with no data when a HTTP shutdown has completed.multicolour.on(event, callback(event))Listen for an event fired on Multicolour core.Returns: MulticolourExample:const my_service = require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()my_service.on(&quot;database_started&quot;, () =&amp;gt;  console.log(&quot;Bewm, databases are up.&quot;))my_service.start()multicolour.trigger(event, data)Trigger an event on Multicolour core.Returns: MulticolourExample:const my_service = require(&quot;multicolour&quot;)  .new_from_config_file_path(&quot;./config.js&quot;)  .scan()my_service.start(() =&amp;gt; {  my_service.trigger(&quot;service_up&quot;, { my_service })})Other methods can be read up on the Talkie docs."
    }
</script>


            <ul>
  
  
    <li
      data-keywords="multicolour API, API reference"
      
      class="active">
        API Reference
      

      
    </li>
  
    <li
      data-keywords="multicolour, cli"
      
      >
      <a href="/docs/0.6.3/cli" title="Multicolour documentation CLI">
        CLI
      </a>
      

      
    </li>
  
    <li
      data-keywords="waterline blueprints, multicolour collection, database, table, define, migration"
      
      >
      <a href="/docs/0.6.3/collections/" title="Multicolour documentation collections">
        Collections/Blueprints
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour config, server configuration, rest api config"
      
      >
      <a href="/docs/0.6.3/configuration" title="Multicolour documentation configuration">
        Configuration
      </a>
      

      
    </li>
  
    <li
      data-keywords="codeless business logic, multicolour constraints"
      
      >
      <a href="/docs/0.6.3/collections/constraints/" title="Multicolour documentation constraints">
        Constraints
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, rest api, debugging"
      
      >
      <a href="/docs/0.6.3/debugging" title="Multicolour documentation debugging tips">
        Debugging
      </a>
      

      
    </li>
  
    <li
      data-keywords=""
      
      >
      <a href="/docs/0.6.3/quickstart" title="Multicolour quickstart">
        Quickstart
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, javascript sdk"
      
      >
      <a href="/docs/0.6.3/javascript-sdk" title="Multicolour documentation JavaScript SDK generator">
        JavaScript SDK
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, plugins, rest api business logic"
      
      >
      <a href="/docs/0.6.3/plugins" title="Multicolour documentation plugins">
        Writing plugins
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, REST API routes, routing"
      
      >
      <a href="/docs/0.6.3/routing/" title="Multicolour documentation routing">
        Routing
      </a>
      

      
    </li>
  
    <li
      data-keywords="file uploads, multicolour, rest api file uploads"
      
      >
      <a href="/docs/0.6.3/routing/file-uploads/" title="Multicolour documentation file uploads">
        Uploading files
      </a>
      

      
    </li>
  
</ul>

            
        </aside>
        <article>
          <h2 id="multicolour">Multicolour</h2>

<p>Multicolour aims to make your life simpler, smarter and quicker by generating the boilerplate code for you including authentication and data representation layer.</p>

<p>Multicolour core is a message bus, using the <a href="https://www.npmjs.com/package/@newworldcode/talkie">Talkie</a> package.</p>

<p>This allows Multicolour to act as two things:</p>

<ul>
  <li>An <code class="highlighter-rouge">EventEmitter</code></li>
  <li>a request and reply interface</li>
</ul>

<p>The difference between the two is merely semantic, it allows us to make reading the code more natural and simplify certain aspects of the code resolution process <em>(“What does this do?” .. “Oh, that.”)</em></p>

<p>Multicolour “extends” all plugins with it’s message bus so all plugins have a predictable interface.</p>

<h2 id="new-multicolour-config-"><code class="highlighter-rouge">new Multicolour({ config })</code></h2>

<p>Create an instance of Multicolour, <code class="highlighter-rouge">config</code> should be a valid configuration object for multicolour to scan for blueprints and connect to your databases.</p>

<p>Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">Multicolour</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Multicolour</span><span class="p">({</span>
  <span class="na">content</span><span class="p">:</span> <span class="err">`</span><span class="nx">$</span><span class="p">{</span><span class="nx">__dirname</span><span class="p">}</span><span class="sr">/content</span><span class="err">`
</span><span class="p">})</span></code></pre></figure>

<hr />

<h2 id="multicolourgetkey-string"><code class="highlighter-rouge">multicolour.get(key String)</code></h2>

<p>Get any of the following properties values from Multicolour core, some properties are only available once the service has been <code class="highlighter-rouge">.start()</code>-ed.</p>

<ul>
  <li><code class="highlighter-rouge">"cli"</code> - <code class="highlighter-rouge">Object</code> Uninitialised CLI module.</li>
  <li><code class="highlighter-rouge">"config"</code> - <code class="highlighter-rouge">Map</code> The config as a <code class="highlighter-rouge">Map</code>, top level properties are also <code class="highlighter-rouge">Map</code>s.</li>
  <li><code class="highlighter-rouge">"env"</code> - <code class="highlighter-rouge">String</code> the <code class="highlighter-rouge">process.env.NODE_ENV</code> value at startup and <code class="highlighter-rouge">"development"</code> by default.</li>
  <li><code class="highlighter-rouge">"has_scanned"</code> - <code class="highlighter-rouge">Boolean</code> whether Multicolour has <code class="highlighter-rouge">.scan()</code>ned for blueprints.</li>
  <li><code class="highlighter-rouge">"package"</code> - <code class="highlighter-rouge">Object</code> The contents of the app’s <code class="highlighter-rouge">package.json</code> if any.</li>
  <li><code class="highlighter-rouge">"blueprints"</code> - <code class="highlighter-rouge">Object</code> Only available after <code class="highlighter-rouge">.scan()</code> has run.</li>
  <li><code class="highlighter-rouge">"validators"</code> - <code class="highlighter-rouge">Multicolour_Default_Validation</code> class instance for payload and response validation.</li>
  <li><code class="highlighter-rouge">"handlers"</code> - <code class="highlighter-rouge">Multicolour_Route_Templates</code> class instance which contain the default handlers for the database work.</li>
  <li><code class="highlighter-rouge">"database"</code> - <code class="highlighter-rouge">Map</code> Only available after <code class="highlighter-rouge">.start()</code> has completed, the database plugin.</li>
  <li><code class="highlighter-rouge">"server"</code> - <code class="highlighter-rouge">Object</code> Only available after <code class="highlighter-rouge">.start()</code> has completed, the server plugin.</li>
</ul>

<p>Returns: <code class="highlighter-rouge">Any</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">my_service</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"env"</span><span class="p">))</span> <span class="c1">// development</span></code></pre></figure>

<p>Getting core modules such as <code class="highlighter-rouge">database</code> and <code class="highlighter-rouge">server</code> will return full plugin instances.</p>

<p>–</p>

<h3 id="multicolourgetdatabase"><code class="highlighter-rouge">multicolour.get("database")</code></h3>

<p>Will return the full <code class="highlighter-rouge">Multicolour_Waterline_Generator</code> instance including the full waterline object and another Talkie interface.</p>

<p>Available to <code class="highlighter-rouge">.get</code></p>

<h4 id="multicolourgetdatabasegetmodels"><code class="highlighter-rouge">multicolour.get("database").get("models")</code></h4>

<p>An object of each, raw waterline collection registered.</p>

<h4 id="multicolourgetdatabasegetwaterline"><code class="highlighter-rouge">multicolour.get("database").get("waterline")</code></h4>

<p>The raw Waterline object underneath.</p>

<p>–</p>

<h3 id="multicolourgetserver"><code class="highlighter-rouge">multicolour.get("server")</code></h3>

<p>A requirement of each server plugin is that it register as <code class="highlighter-rouge">"server"</code> on Multicolour core</p>

<p>Available to read:</p>

<h4 id="multicolourgetserverrequestraw"><code class="highlighter-rouge">multicolour.get("server").request("raw")</code></h4>

<p>Raw server tech, be it Hapi or Express or whatever plugin you chose to use.</p>

<h4 id="multicolourgetservergetapi_root"><code class="highlighter-rouge">multicolour.get("server").get("api_root")</code></h4>

<p>The final resolved url the API can be reached at, is 100% truth once the server has started and only a “guess” before the <code class="highlighter-rouge">server_started</code> event is emitted.</p>

<p>The guess is 95% correct as it is derived from your configuration file but is not 100%.</p>

<p>To read about what more is available to <code class="highlighter-rouge">.get</code> or .<code class="highlighter-rouge">request</code></p>

<h4 id="multicolourgetserverrequestcsrf_enabled"><code class="highlighter-rouge">multicolour.get("server").request("csrf_enabled")</code></h4>

<p>All endorsed server plugins are required to implement a way of enabling or disabling CSRF tokens for security reasons.</p>

<p>This will return a <code class="highlighter-rouge">Boolean</code> as to whether CSRF token generation is enabled or not (defaults to false.)</p>

<h4 id="multicolourgetservergetflow_runner"><code class="highlighter-rouge">multicolour.get("server").get("flow_runner")</code></h4>

<p>Server plugins should implement a <code class="highlighter-rouge">flow_runner</code> used by Multicolour core as part of it’s built in integration testing framework. This should return an executable function.</p>

<hr />

<h2 id="multicolourrequestkey"><code class="highlighter-rouge">multicolour.request(key)</code></h2>

<p>Request a property from Multicolour, this is merely semantic sugar. Available properties are:</p>

<ul>
  <li><code class="highlighter-rouge">"cli"</code> - <code class="highlighter-rouge">CLI</code> newly initialised CLI module.</li>
  <li><code class="highlighter-rouge">"new_uuid"</code> - <code class="highlighter-rouge">String</code> a unique v4 uuid.</li>
  <li><code class="highlighter-rouge">"storage"</code> - Get the current storage plugin.</li>
</ul>

<p>Returns: <code class="highlighter-rouge">Any</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">my_service</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s2">"new_uuid"</span><span class="p">))</span> <span class="c1">// 5d31d224-bf23-49ed-9db0-7a50ab924f4f</span></code></pre></figure>

<hr />

<h2 id="static-new_from_config_file_pathconfig_location"><code class="highlighter-rouge">static new_from_config_file_path(config_location)</code></h2>

<p>Create a new instance of Multicolour from a config file location.</p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L112-L129">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">).</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span></code></pre></figure>

<hr />

<h2 id="multicolourreset_from_config_pathconfig_location"><code class="highlighter-rouge">multicolour.reset_from_config_path(config_location)</code></h2>

<p>Reset this instance of Multicolour with a config file location.</p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L131-L139">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">Multicolour</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">Multicolour</span><span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>

<span class="c1">// Actually changed my mind.</span>
<span class="nx">my_service</span><span class="p">.</span><span class="nx">reset_from_config_path</span><span class="p">(</span><span class="s2">"./my-other-config.js"</span><span class="p">)</span></code></pre></figure>

<hr />

<h2 id="multicolourcli"><code class="highlighter-rouge">multicolour.cli()</code></h2>

<p>Start the CLI tools and parse arguments.</p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L141-L152">Source Code</a><br />
Returns: <code class="highlighter-rouge">CLI</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="cp">#!/usr/bin/env node
</span>
<span class="c1">// Get Multicolour.</span>
<span class="kr">const</span> <span class="nx">Multicolour</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'multicolour'</span><span class="p">)</span>

<span class="c1">// Instantiate.</span>
<span class="k">new</span> <span class="nx">Multicolour</span><span class="p">().</span><span class="nx">cli</span><span class="p">()</span></code></pre></figure>

<hr />

<h2 id="multicolour_enable_user_model"><code class="highlighter-rouge">multicolour._enable_user_model()</code></h2>

<p>Enable the core user model, usually done so by official authentication plugins.</p>

<p>Will create a new table/collection in your database called <code class="highlighter-rouge">multicolour_user</code>.</p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L154-L172">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="c1">// Get Multicolour.</span>
<span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">_enable_user_model</span><span class="p">()</span></code></pre></figure>

<hr />

<h2 id="multicolourscan"><code class="highlighter-rouge">multicolour.scan()</code></h2>

<p>Tells Multicolour that you and the server are ready to be scanned for blueprints. The search path is dictated by the <code class="highlighter-rouge">config.content</code> property.</p>

<p>Once scan has completed a new property is made available via the <code class="highlighter-rouge">Multicolour.get()</code> interface. These are</p>

<ul>
  <li><code class="highlighter-rouge">"blueprints"</code></li>
</ul>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L174-L214">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span></code></pre></figure>

<hr />

<h2 id="multicolouruseplugin"><code class="highlighter-rouge">multicolour.use(Plugin)</code></h2>

<p>Tell Multicolour to register and “use” the supplied plugin. Your plugin must have a <code class="highlighter-rouge">register</code> method on it.</p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L216-L238">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">class</span> <span class="nx">my_plugin</span> <span class="p">{</span>
  <span class="nx">register</span><span class="p">(</span><span class="nx">Multicolour</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">Multicolour</span><span class="p">.</span><span class="nx">reply</span><span class="p">(</span><span class="s2">"ping"</span><span class="p">,</span> <span class="s2">"pong"</span><span class="p">)</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span>

  <span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">my_plugin</span><span class="p">)</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">my_service</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s2">"ping"</span><span class="p">))</span> <span class="c1">// pong</span></code></pre></figure>

<hr />

<h2 id="multicolourstartcallback">multicolour.start(callback)</h2>

<p>Start the database server(s) and the http server and start listening for requests. When both services are ready <code class="highlighter-rouge">callback</code> is called.</p>

<p>Triggers</p>

<p><code class="highlighter-rouge">server_starting</code><br />
<code class="highlighter-rouge">database_starting</code></p>

<p>events on the Multicolour instance and once services are started triggers</p>

<p><code class="highlighter-rouge">server_started</code><br />
 <code class="highlighter-rouge">database_started</code>
 events.</p>

<p>Also sets up a listener for <code class="highlighter-rouge">SIGINT</code> on the process so the services can be <code class="highlighter-rouge">.stop()</code>ped gracefully</p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L240-L269">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span>
  <span class="p">.</span><span class="nx">start</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Database server started"</span><span class="p">))</span></code></pre></figure>

<h2 id="multicolourstopcallback">multicolour.stop(callback)</h2>

<p>Stop the database server(s) and the http server and stop listening for requests. When both services are stopped <code class="highlighter-rouge">callback</code> is called.</p>

<p>Triggers</p>

<p><code class="highlighter-rouge">database_stopping</code><br />
<code class="highlighter-rouge">server_stopping</code></p>

<p>events on the Multicolour instance and once services are stopped triggers</p>

<p><code class="highlighter-rouge">database_stopped</code><br />
<code class="highlighter-rouge">server_stopped</code></p>

<p><a href="https://github.com/Multicolour/multicolour/blob/master/index.js#L271-L326">Source Code</a><br />
Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span>

<span class="nx">my_service</span><span class="p">.</span><span class="nx">start</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"HTTP &amp; Database server(s) started"</span><span class="p">)</span>

  <span class="nx">my_service</span><span class="p">.</span><span class="nx">stop</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"HTTP &amp; Database server(s) stopped"</span><span class="p">))</span>
<span class="p">})</span></code></pre></figure>

<h2 id="request-and-reply-arbitrary-data">Request and Reply arbitrary data</h2>

<p><a href="https://www.npmjs.com/package/@newworldcode/talkie">Talkie</a> enables Multicolour to act both as an <code class="highlighter-rouge">EventEmitter</code> and as a messaging bus to send arbitrary data to multiple places at once and on the object it extends.</p>

<p>Talkie adds <code class="highlighter-rouge">request</code> and <code class="highlighter-rouge">reply</code> functions to all extended objects.</p>

<h3 id="multicolourreplyname-data"><code class="highlighter-rouge">multicolour.reply(name, data)</code></h3>

<p>When <code class="highlighter-rouge">name</code> is <code class="highlighter-rouge">request</code>ed, it will receive the <code class="highlighter-rouge">data</code> unmodified.</p>

<p>Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="nx">multicolour</span><span class="p">.</span><span class="nx">reply</span><span class="p">(</span><span class="s2">"my_awesome_plugin"</span><span class="p">,</span> <span class="k">new</span> <span class="kr">class</span> <span class="p">{})</span></code></pre></figure>

<h3 id="multicolourrequestname"><code class="highlighter-rouge">multicolour.request(name)</code></h3>

<p>Purely syntactic sugar, is no different in functionality than <code class="highlighter-rouge">.get(name)</code>.</p>

<p>Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">my_awesome_plugin</span> <span class="o">=</span> <span class="nx">multicolour</span><span class="p">.</span><span class="nx">request</span><span class="p">(</span><span class="s2">"my_awesome_plugin"</span><span class="p">)</span></code></pre></figure>

<h2 id="eventemitter">EventEmitter</h2>

<p>Multicolour is an <code class="highlighter-rouge">EventEmitter</code>, events can be triggered and listened to using the standard interface for inter-plugin communication.</p>

<p>At <strong>any</strong> point an event can be triggered and listened to in your app’s lifetime.</p>

<p>All events are asyncronous, results from a trigger cannot be attained without providing a callback in the data sent.</p>

<p>All plugins that used by Multicolour are also made into message busses with the exact same interface as Multicolour and access to all the Multicolour events.</p>

<h3 id="events">Events</h3>

<p>These events are fired from core and emit no data.</p>

<h4 id="database_starting"><code class="highlighter-rouge">database_starting</code></h4>

<p>Emitted with no data when a database startup has been started.</p>

<h4 id="database_started"><code class="highlighter-rouge">database_started</code></h4>

<p>Emitted with no data when a database startup has completed.</p>

<h4 id="database_stopping"><code class="highlighter-rouge">database_stopping</code></h4>

<p>Emitted with no data when a database shutdown has been started.</p>

<h4 id="database_stopped"><code class="highlighter-rouge">database_stopped</code></h4>

<p>Emitted with no data when a database shutdown has completed.</p>

<h4 id="server_stopping"><code class="highlighter-rouge">server_stopping</code></h4>

<p>Emitted with no data when a HTTP server shutdown has been started.</p>

<h4 id="server_stopped"><code class="highlighter-rouge">server_stopped</code></h4>

<p>Emitted with no data when a HTTP shutdown has completed.</p>

<h3 id="multicolouronevent-callbackevent">multicolour.on(event, callback(event))</h3>

<p>Listen for an event fired on Multicolour core.</p>

<p>Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span>

<span class="nx">my_service</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"database_started"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"Bewm, databases are up."</span><span class="p">))</span>

<span class="nx">my_service</span><span class="p">.</span><span class="nx">start</span><span class="p">()</span></code></pre></figure>

<h3 id="multicolourtriggerevent-data">multicolour.trigger(event, data)</h3>

<p>Trigger an event on Multicolour core.</p>

<p>Returns: <code class="highlighter-rouge">Multicolour</code><br />
Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">my_service</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">"multicolour"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">new_from_config_file_path</span><span class="p">(</span><span class="s2">"./config.js"</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">scan</span><span class="p">()</span>

<span class="nx">my_service</span><span class="p">.</span><span class="nx">start</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">my_service</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">"service_up"</span><span class="p">,</span> <span class="p">{</span> <span class="nx">my_service</span> <span class="p">})</span>
<span class="p">})</span></code></pre></figure>

<p>Other methods can be read up on the <a href="https://www.npmjs.com/package/@newworldcode/talkie">Talkie docs.</a></p>


        </article>
      </section>
    </main>

    <footer class="site-footer">

  <ul>
    <li>
      <a href="/code-of-conduct" title="Multicolour code of conduct">
        Code of Conduct
      </a>
    </li>
    <li>
      <a href="/Multicolour_Branding_Guidelines_2016.pdf" target="_blank" rel="nofollow noopener noreferrer">
        Branding guidelines
      </a>
    </li>
    <li>
      <a href="https://github.com/Multicolour" target="_blank" rel="nofollow noopener noreferrer">
        Github Organisation
      </a>
    </li>
  </ul>
  <p>&copy; All copyright to Get Multicolour &amp; New World Code Ltd 2017</p>
</footer>

<script src="/js/main.js" async defer></script>
<script>
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
    analytics.load("Qurt0kpTtzocuF8h8VgRH6ygztdQPK5i");
    analytics.page()
  }}();
</script>


</body>

</html>
