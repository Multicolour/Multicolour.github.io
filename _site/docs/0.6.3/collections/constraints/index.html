<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Multicolour documentation constraints</title>

  <!-- Base -->
<meta name="identifier-url" content="site.url" />
<meta name="title" content="Multicolour documentation constraints" />
<meta name="description" content="Add logic to your REST API without writing code" />
<meta name="abstract" content="Constraints" />
<meta name="keywords" content="codeless business logic, multicolour constraints" />
<meta name="author" content="New World Code Ltd" />
<meta name="revisit-after" content="7" />
<meta name="language" content="en" />
<meta name="copyright" content="© 2017 New World Code Ltd" />
<meta name="robots" content="Index" />


<!-- Social -->
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@getmulticolour">
<meta name="twitter:title" content="Multicolour documentation constraints">
<meta name="twitter:description" content="Constraints">
<meta name="twitter:creator" content="@getmulticolour">
<meta name="twitter:image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png">

<meta itemprop="name" content="Multicolour documentation constraints">
<meta itemprop="description" content="Constraints">
<meta itemprop="image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png">

<meta property="og:title" content="Multicolour documentation constraints" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://0.0.0.0:4000" />
<meta property="og:image" content="http://0.0.0.0:4000/images/MC_Icon_PurpleRain_Logotype.png" />
<meta property="og:description" content="Constraints" />
<meta property="og:site_name" content="Multicolour documentation constraints" />

<link rel="icon" href="/images/iconography/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="/images/iconography/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/images/iconography/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/images/iconography/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/images/iconography/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/images/iconography/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/images/iconography/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/images/iconography/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/images/iconography/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/iconography/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192"  href="/images/iconography/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="/images/iconography/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="/images/iconography/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="/images/iconography/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<meta name="msapplication-TileColor" content="#FF9999">
<meta name="msapplication-TileImage" content="/images/iconography/ms-icon-144x144.png">
<meta name="theme-color" content="#FF9999">



  <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,300" rel="stylesheet" type="text/css" async>
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://0.0.0.0:4000/docs/0.6.3/collections/constraints/">
  <link rel="alternate" type="application/rss+xml" title="Multicolour - Rest API generator" href="http://0.0.0.0:4000/feed.xml">
</head>


<body>
    <main class="docs">
      <div class="general-nav">
    <nav>
        <a href="/" class="logo-link no-border" title="Multicolour - Rest API generator">
            <img class="nav-logo" src="/images/logo-stamp.svg" alt="Multicolour - Rest API generator">
        </a>

        <ul class="menu">
            <li>
                <a href="/examples/" title="Multicolour rest api generator examples">examples</a>
            </li>
            <li>
                <a href="/docs/" title="Multicolour docs">docs</a>
            </li>
            <li>
                <a href="/blog/" title="Multicolour blog">blog</a>
            </li>
        </ul>
    </nav>

    <menu class="breadcrumb-menu">
        <h1>Multicolour documentation constraints</h1>

        <div class="breadcrumbs">
  <a class="breadcrumbs-logo" href="/" title="Multicolour - Rest API generator">
    <img src="/images/iconography/android-icon-36x36.png" alt="Multicolour - Rest API generator">
  </a>

  <span class="arrow">&rarr;</span>

  
  
  <a href="/docs/" title="docs">
    docs
  </a>

  <span class="arrow">&rarr;</span>
  
  <a href="/docs/0.6.3/" title="0.6.3">
    0.6.3
  </a>

  <span class="arrow">&rarr;</span>
  
  <a href="/docs/0.6.3/collections/" title="collections">
    collections
  </a>

  <span class="arrow">&rarr;</span>
  
  

  <a class="current" href="/docs/0.6.3/collections/constraints/" title="Multicolour documentation constraints">
    
    Constraints
    
  </a>
</div>

    </menu>
</div>


      <section class="columns">
        <aside>
            
            <h2 class="title">Docs <span>0.6.3</span></h2>
            
            <section class="search">
                <input type="search" name="search" placeholder="search the docs">
            </section>

            
            

<script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "APIReference",
        "headline": "Multicolour documentation constraints",
        "assemblyVersion": "0.6.3",
        "executableLibraryName": "multicolour",
        "targetPlatform": "NodeJS",
        "keywords": "codeless business logic, multicolour constraints",
        "learningResourceType": ["learning activity"],
        "wordCount": "522",
        "datePublished": "2017-03-10 11:15:01 +0000",
        "url": "/docs/0.6.3/collections/constraints/",
        "publisher": {
            "@type": "Organization",
            "name": "Multicolour",
            "sameAs": [
                "https://twitter.com/getmulticolour",
                "https://github.com/Multicolour"
            ],
            "logo": {
                "@type": "ImageObject",
                "contentUrl": "http://0.0.0.0:4000/images/logo.png",
                "url": "http://0.0.0.0:4000"
            }
        },
        "image":{
            "@type":"ImageObject",
            "contentUrl":"http://0.0.0.0:4000/images/social-header.jpg",
            "url":"http://0.0.0.0:4000",
            "height":"500",
            "width":"1500"
         },
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http://0.0.0.0:4000/docs/0.6.3/collections/constraints/"
        },
        "articleBody": "ConstraintsA constraint in Multicolour is a simple string in your models to define a limiting behaviour on for certain types of actions, such as making sure when something is created it gets assigned the logged in user’s identifier for ownership.Constraints exist to replace simple, common business logic without having to write JavaScript and they come in a few formats that is described in the following spec.Specification{  [verb String]: {    [key String]: Function|ComparativeString|ConstraintObject,  }}Where ComparativeString is a String with the following format:const comparatives = new Map([  [&quot;&amp;lt;&quot;, &quot;&amp;lt;&quot;],  [&quot;&amp;gt;&quot;, &quot;&amp;gt;&quot;],  [&quot;&amp;lt;=&quot;, &quot;&amp;lt;=&quot;],  [&quot;&amp;gt;=&quot;, &quot;&amp;gt;=&quot;],  [&quot;!&quot;, &quot;!&quot;],  [&quot;^&quot;, &quot;startsWith&quot;],  [&quot;$&quot;, &quot;endsWith&quot;],  [&quot;%&quot;, &quot;like&quot;]])[Comparative?] path.to.data.in.request.objectand ConstraintObject is an Object with the following format:{  [key String]: {    compile: Bool false,    value: compile ? ComparativeString : (String|Number|null)  },}Example and common usesThe most common constraint is ensuring a user has sufficient privileges to read/write something and would come in the form of{  user: &quot;auth.credentials.user.id&quot;}The way this works is the String is a path to an object on the request object, this is in-fact setting the constraint to the value of request.auth.credentials.user.id in the incoming request.More examples{  role: &quot;auth.session.role&quot;}{  name: {    compile: false,    value: &quot;Multicolour&quot;  }}{  createdAt: &quot;&amp;gt;= &quot; + new Date(2015)}{  age: {    compile: false,    value: &quot;&amp;gt;= 18&quot;  }}Verbs and constraintsYou must specify your constraints on all the http verbs you wish to constrain. The verbs must appear as lowercase.Example:...constraints: {  get: { public: { compile: false, value: true } },  post: { user: &quot;auth.credentials.user.id&quot; },  put: { user: &quot;auth.credentials.user.id&quot; },  delete: { user: &quot;auth.credentials.user.id&quot; },  patch: { user: &quot;auth.credentials.user.id&quot; }},..."
    }
</script>


            <ul class="search-results">
  
  
    <li
      data-keywords="multicolour API, API reference"
      
      class="visible">
      <a href="/docs/0.6.3/api-reference" title="Multicolour core API reference">
        API Reference
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, cli"
      
      class="visible">
      <a href="/docs/0.6.3/cli" title="Multicolour documentation CLI">
        CLI
      </a>
      

      
    </li>
  
    <li
      data-keywords="waterline blueprints, multicolour collection, database, table, define, migration"
      
      class="visible">
      <a href="/docs/0.6.3/collections/" title="Multicolour documentation collections">
        Collections/Blueprints
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour config, server configuration, rest api config"
      
      class="visible">
      <a href="/docs/0.6.3/configuration" title="Multicolour documentation configuration">
        Configuration
      </a>
      

      
    </li>
  
    <li
      data-keywords="codeless business logic, multicolour constraints"
      
      class="active visible">
        Constraints
      

      
    </li>
  
    <li
      data-keywords="database, migration, data, existing database, automatic"
      
      class="visible">
      <a href="/docs/0.6.3/collections/migration/" title="Multicolour documentation database migration">
        Migration
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, rest api, debugging"
      
      class="visible">
      <a href="/docs/0.6.3/debugging" title="Multicolour documentation debugging tips">
        Debugging
      </a>
      

      
    </li>
  
    <li
      data-keywords=""
      
      class="visible">
      <a href="/docs/0.6.3/quickstart" title="Multicolour quickstart">
        Quickstart
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, javascript sdk"
      
      class="visible">
      <a href="/docs/0.6.3/javascript-sdk" title="Multicolour documentation JavaScript SDK generator">
        JavaScript SDK
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, plugins, rest api business logic"
      
      class="visible">
      <a href="/docs/0.6.3/plugins" title="Multicolour documentation plugins">
        Writing plugins
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, REST API routes, routing"
      
      class="visible">
      <a href="/docs/0.6.3/routing/" title="Multicolour documentation routing">
        Routing
      </a>
      

      
    </li>
  
    <li
      data-keywords="rest api query, results filtering, searching"
      
      class="visible">
      <a href="/docs/0.6.3/routing/results/" title="Multicolour documentation result filtering">
        Results Filtering
      </a>
      

      
    </li>
  
    <li
      data-keywords="multicolour, server, http"
      
      class="visible">
      <a href="/docs/0.6.3/server/" title="Multicolour server docs">
        Server
      </a>
      

      
    </li>
  
    <li
      data-keywords="file uploads, multicolour, rest api file uploads"
      
      class="visible">
      <a href="/docs/0.6.3/routing/file-uploads/" title="Multicolour documentation file uploads">
        Uploading files
      </a>
      

      
    </li>
  
</ul>

            
        </aside>
        <article>
          <h1 id="constraints">Constraints</h1>

<p>A constraint in Multicolour is a simple string in your models to define a limiting behaviour on for certain types of actions, such as making sure when something is created it gets assigned the logged in user’s identifier for ownership.</p>

<p>Constraints exist to replace simple, common business logic without having to write JavaScript and they come in a few formats that is described in the following spec.</p>

<h3 id="specification">Specification</h3>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="p">[</span><span class="nx">verb</span> <span class="nb">String</span><span class="p">]</span><span class="err">:</span> <span class="p">{</span>
    <span class="p">[</span><span class="nx">key</span> <span class="nb">String</span><span class="p">]</span><span class="err">:</span> <span class="nb">Function</span><span class="o">|</span><span class="nx">ComparativeString</span><span class="o">|</span><span class="nx">ConstraintObject</span><span class="p">,</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<p>Where <code class="highlighter-rouge">ComparativeString</code> is a <code class="highlighter-rouge">String</code> with the following format:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="kr">const</span> <span class="nx">comparatives</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Map</span><span class="p">([</span>
  <span class="p">[</span><span class="s2">"&lt;"</span><span class="p">,</span> <span class="s2">"&lt;"</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"&gt;"</span><span class="p">,</span> <span class="s2">"&gt;"</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"&lt;="</span><span class="p">,</span> <span class="s2">"&lt;="</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"&gt;="</span><span class="p">,</span> <span class="s2">"&gt;="</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"!"</span><span class="p">,</span> <span class="s2">"!"</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"^"</span><span class="p">,</span> <span class="s2">"startsWith"</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"$"</span><span class="p">,</span> <span class="s2">"endsWith"</span><span class="p">],</span>
  <span class="p">[</span><span class="s2">"%"</span><span class="p">,</span> <span class="s2">"like"</span><span class="p">]</span>
<span class="p">])</span>

<span class="p">[</span><span class="nx">Comparative</span><span class="p">?]</span> <span class="nx">path</span><span class="p">.</span><span class="nx">to</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="k">in</span><span class="p">.</span><span class="nx">request</span><span class="p">.</span><span class="nx">object</span></code></pre></figure>

<p>and <code class="highlighter-rouge">ConstraintObject</code> is an <code class="highlighter-rouge">Object</code> with the following format:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="p">[</span><span class="nx">key</span> <span class="nb">String</span><span class="p">]</span><span class="err">:</span> <span class="p">{</span>
    <span class="nl">compile</span><span class="p">:</span> <span class="nx">Bool</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">value</span><span class="err">:</span> <span class="nx">compile</span> <span class="p">?</span> <span class="nx">ComparativeString</span> <span class="p">:</span> <span class="p">(</span><span class="nb">String</span><span class="o">|</span><span class="nb">Number</span><span class="o">|</span><span class="kc">null</span><span class="p">)</span>
  <span class="p">},</span>
<span class="p">}</span></code></pre></figure>

<h3 id="example-and-common-uses">Example and common uses</h3>

<p>The most common constraint is ensuring a user has sufficient privileges to read/write something and would come in the form of</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="nl">user</span><span class="p">:</span> <span class="s2">"auth.credentials.user.id"</span>
<span class="p">}</span></code></pre></figure>

<p>The way this works is the <code class="highlighter-rouge">String</code> is a path to an object on the <code class="highlighter-rouge">request</code> object, this is in-fact setting the constraint to the value of <code class="highlighter-rouge">request.auth.credentials.user.id</code> in the incoming request.</p>

<h4 id="more-examples">More examples</h4>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">{</span>
  <span class="nl">role</span><span class="p">:</span> <span class="s2">"auth.session.role"</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="nl">name</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">compile</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">value</span><span class="err">:</span> <span class="s2">"Multicolour"</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="nl">createdAt</span><span class="p">:</span> <span class="s2">"&gt;= "</span> <span class="o">+</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2015</span><span class="p">)</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="nl">age</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">compile</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nx">value</span><span class="err">:</span> <span class="s2">"&gt;= 18"</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre></figure>

<h2 id="verbs-and-constraints">Verbs and constraints</h2>

<p>You must specify your constraints on all the http verbs you wish to constrain. The verbs must appear as lowercase.</p>

<p>Example:</p>

<figure class="highlight"><pre><code class="language-js" data-lang="js"><span class="p">...</span>
<span class="nl">constraints</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">get</span><span class="p">:</span> <span class="p">{</span> <span class="nl">public</span><span class="p">:</span> <span class="p">{</span> <span class="nl">compile</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span> <span class="nx">value</span><span class="err">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">},</span>
  <span class="nx">post</span><span class="err">:</span> <span class="p">{</span> <span class="nl">user</span><span class="p">:</span> <span class="s2">"auth.credentials.user.id"</span> <span class="p">},</span>
  <span class="nx">put</span><span class="err">:</span> <span class="p">{</span> <span class="nl">user</span><span class="p">:</span> <span class="s2">"auth.credentials.user.id"</span> <span class="p">},</span>
  <span class="k">delete</span><span class="err">:</span> <span class="p">{</span> <span class="nl">user</span><span class="p">:</span> <span class="s2">"auth.credentials.user.id"</span> <span class="p">},</span>
  <span class="nx">patch</span><span class="err">:</span> <span class="p">{</span> <span class="nl">user</span><span class="p">:</span> <span class="s2">"auth.credentials.user.id"</span> <span class="p">}</span>
<span class="p">},</span>
<span class="p">...</span></code></pre></figure>


        </article>
      </section>
    </main>

    <footer class="site-footer">

  <ul>
    <li>
      <a href="/code-of-conduct" title="Multicolour code of conduct">
        Code of Conduct
      </a>
    </li>
    <li>
      <a href="/Multicolour_Branding_Guidelines_2016.pdf" target="_blank" rel="nofollow noopener noreferrer">
        Branding guidelines
      </a>
    </li>
    <li>
      <a href="https://github.com/Multicolour" target="_blank" rel="nofollow noopener noreferrer">
        Github Organisation
      </a>
    </li>
  </ul>
  <p>&copy; All copyright to Get Multicolour &amp; New World Code Ltd 2017</p>
</footer>

<script src="/js/main.js" async defer></script>
<script>
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
    analytics.load("Qurt0kpTtzocuF8h8VgRH6ygztdQPK5i");
    analytics.page()
  }}();
</script>


</body>

</html>
